<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <!-- Bootstrap -->
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <style>
    .userStatements>.row {
      margin-bottom: 20px;
    }

    .title-hr {
      border-top: 1px solid #000;
      border-bottom: 1px solid #000;
      height: 8px;
    }

    #deviceData {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: flex-start;
      border: 1px solid #eceff9;
    }

    .card {
      border: 1px solid #ddd;
      text-align: center;
      box-sizing: border-box;
      -moz-box-shadow: 0 0 5px 0px #ddd;
      -webkit-box-shadow: 0 0 5px 0px #ddd;
      box-shadow: 0 0 5px 0px #ddd;
      margin: 10px;
      flex: 1;
      min-width: 150px;
    }

    .card>.card-header {
      border-bottom: 1px solid #ddd;
      padding: 15px 10px;
    }

    .card>.card-body {
      display: flex;
      align-items: center;
      justify-content: space-evenly;
      padding: 15px 10px;
    }

    .card-body>.card-body-left {
      font-size: 30px;
      flex: 2;
    }

    .echartsDiagram {
      box-sizing: border-box;
      min-height: 450px;
      border: 1px solid #eceff9;
      padding: 15px;
    }
  </style>
</head>

<body>
  <div class="container userStatements">
    <div class="row clearfix">
      <div class="col-md-12 column">
        <h3 class="text-center">
          <span class="report-year">2021</span>年物联网设备运行数据报告
        </h3>
        <div class="title-hr center-block"></div>
      </div>
    </div>
    <div class="row clearfix">
      <div class="col-md-12 column">
        <p>
          <span class="glyphicon glyphicon-stop" aria-hidden="true"></span> 感谢您一直以来对系统的使用和支持，<span
            class="report-year">2021</span>年物联网设备运行数据统计如下：
        </p>
        <div id="deviceData">
        </div>
      </div>
    </div>
    <div class="row clearfix">
      <div class="col-md-12 column">
        <p>
          <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
          <strong>修改参数功能</strong>您总共使用了5次，为终端用户大约节省了本地操作时间共10小时（备注：平均一次相当于10分钟）
        </p>
        <div class="row clearfix">
          <div class="col-md-6 column">
            <div class="echartsDiagram" id="echarts-dataset1">
            </div>
          </div>
          <div class="col-md-6 column">
            <div class="echartsDiagram" id="echarts-annular1">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row clearfix">
      <div class="col-md-12 column">
        <p>
          <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
          <strong>控制参数功能</strong>您总共使用了10次，对设备远程开关机避免浪费电能，为终端用户大约减少了电能共5KW·h
        </p>
        <div class="row clearfix">
          <div class="col-md-6 column">
            <div class="echartsDiagram" id="echarts-dataset2">
            </div>
          </div>
          <div class="col-md-6 column">
            <div class="echartsDiagram" id="echarts-annular2">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row clearfix">
      <div class="col-md-12 column">
        <p>
          <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
          <strong>解锁机功能</strong>您总共使用了3次，帮助您执行回款的商务行为，相当于收回尾款大约5万元
        </p>
        <div class="row clearfix">
          <div class="col-md-12 column">
            <div class="echartsDiagram" id="echarts-annular3">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row clearfix">
      <div class="col-md-12 column">
        <p>
          <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
          <strong>远程升级终端程序功能</strong>您总共使用了5次，通过远程程序更新和在线监控。可快速查询故障原因，方便更新设备程序，减少出差频率，大概降低出差成本约10万元
        </p>
        <div class="row clearfix">
          <div class="col-md-12 column">
            <div class="echartsDiagram" id="echarts-dataset3">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row clearfix">
      <div class="col-md-12 column">
        <div class="row clearfix">
          <div class="col-md-6 column" id="flowTable">
            <p>
              <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
              <strong>流量使用排行TOP10</strong>
            </p>
          </div>
          <div class="col-md-6 column" id="terminalTable">
            <p>
              <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
              <strong>终端设备使用排行TOP10</strong>
            </p>
          </div>
        </div>
        <div class="row clearfix">
          <div class="col-md-6 column" id="faultTable">
            <p>
              <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
              <strong>告警故障类型排行TOP10</strong>
            </p>
          </div>
          <div class="col-md-6 column" id="moduleTable">
            <p>
              <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
              <strong>最常用功能排行TOP10</strong>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="js/jquery-2.0.0.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/echarts.min.js"></script>
  <script>
    $(function () {

      // 获取当前系统年份
      var year = new Date().getFullYear();
      $('.report-year').html(year)

      // 设备数据项
      var deviceData = [
        { "dataTitle": "新增设备数量", "dataValue": "500台" },
        { "dataTitle": "设备总数量", "dataValue": "50000台" },
        { "dataTitle": "设备年度平均在线率", "dataValue": "50%" },
        { "dataTitle": "账号登录次数", "dataValue": "55次" },
        { "dataTitle": "修改监控参数次数", "dataValue": "5次" },
        { "dataTitle": "远程控制设备次数", "dataValue": "5次" },
        { "dataTitle": "远程升级程序次数", "dataValue": "6次" },
        { "dataTitle": "累计使用流量", "dataValue": "3200M" },
        { "dataTitle": "报警次数", "dataValue": "50次" },
        { "dataTitle": "处理工单", "dataValue": "5条" },
        { "dataTitle": "设备服务费", "dataValue": "50次" },
        { "dataTitle": "报警次数", "dataValue": "1000元" },
        { "dataTitle": "新增用户数", "dataValue": "500人" },
      ]
      deviceData.map(function (item) {
        var temp = '<div class="deviceData-item card"><div class="card-header">' + item.dataTitle + '</div><div class="card-body"><div class="card-body-left">' + item.dataValue + '</div></div></div>';
        $('#deviceData').append(temp);
      })

      /**
       * 柱状图
       * @param {*} divId echart初始化容器ID
       * @param {*} title echart图表标题
       * @param {*} dataset echart柱状图数据
       * @param {*} seriesItemNum echart柱状图标签个数
       * @returns 
       */
      function setEchartsDataset(divId, title, dataset, seriesItemNum) {
        var echartsDataset = echarts.init(document.getElementById(divId));
        var seriesData = [];
        while (seriesItemNum > 0) {
          seriesData.push({
            type: 'bar'
          })
          seriesItemNum -= 1
        }
        var optionDataset = {
          title: {
            text: title
          },
          tooltip: {},
          toolbox: {
            show: true,
            showTitle: true,
            feature: {
              magicType: {
                type: ['line', 'bar']
              },
              brush: {
                type: ['']
              },
              restore: {}
            }
          },
          dataZoom: [
            {
              type: 'inside',
              xAxisIndex: 0,
              start: 0,
              end: 100
            },
            {
              show: true,
              type: 'slider',
              xAxisIndex: 0,
              start: 0,
              end: 100
            }
          ],
          dataset: dataset,
          xAxis: { type: 'category' },
          yAxis: {},
          series: seriesData
        };
        echartsDataset.setOption(optionDataset);
        return echartsDataset;
      }
      var echartBardataset = {
        source: [
          ['product', '2015'],
          ['Matcha', 43.3],
          ['Milk', 83.1],
          ['Cheese', 86.45],
          ['Walnut', 72.4]
        ]
      };

      /**
       * 环形图
       * @param {*} divId echart初始化容器ID
       * @param {*} title echart图表标题
       * @param {*} seriesData echart环形图具体数据对象
       * @returns 
       */
      function setEchartsAnnular(divId, title, seriesData) {
        var echartsAnnular = echarts.init(document.getElementById(divId));
        var optionAnnular = {
          title: {
            text: title
          },
          tooltip: {
            trigger: 'item'
          },
          legend: {
            top: 'bottom'
          },
          series: seriesData
        };
        echartsAnnular.setOption(optionAnnular);
        return echartsAnnular;
      }
      var echartsAnnularseriesData = [
        {
          type: 'pie',
          label: {
            show: true
          },
          labelLine: {
            show: true
          },
          radius: [70, 130],
          center: ['50%', '50%'],
          itemStyle: {
            borderRadius: 8
          },
          data: [
            { value: 40, name: 'rose 1' },
            { value: 38, name: 'rose 2' },
            { value: 32, name: 'rose 3' },
            { value: 30, name: 'rose 4' },
            { value: 28, name: 'rose 5' },
            { value: 26, name: 'rose 6' },
            { value: 22, name: 'rose 7' },
            { value: 18, name: 'rose 8' }
          ]
        }
      ]

      /**
       * 数据图表渲染
       */
      var echartsDgResize = [];
      function renderEchart() {
        // 判断设备类型
        if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
          // echartsAnnularseriesData.radius = [10, 50];
          echartsAnnularseriesData.map(function (item) {
            item.label.show = false;
            item.labelLine.show = false;
          })
        } else {
          echartsAnnularseriesData.map(function (item) {
            item.label.show = true;
            item.labelLine.show = true;
          })
        }
        var echartsDataset1 = setEchartsDataset('echarts-dataset1', "修改参数分类TOP5", echartBardataset, 1);
        var echartsDataset2 = setEchartsDataset('echarts-dataset2', "控制参数分类TOP5", echartBardataset, 1);
        var echartsDataset3 = setEchartsDataset('echarts-dataset3', "远程升级程序分类TOP5", echartBardataset, 1);
        echartsDgResize.push(echartsDataset1, echartsDataset2, echartsDataset3);

        var echartsAnnular1 = setEchartsAnnular('echarts-annular1', "修改参数分类TOP5", echartsAnnularseriesData);
        var echartsAnnular2 = setEchartsAnnular('echarts-annular2', "控制参数分类TOP5", echartsAnnularseriesData);
        var echartsAnnular3 = setEchartsAnnular('echarts-annular3', "解锁机功能使用占比", echartsAnnularseriesData);
        echartsDgResize.push(echartsAnnular1, echartsAnnular2, echartsAnnular3);

        echartsDgResize.map(function (item) {
          item.resize();
        })
      }

      renderEchart();
      window.onresize = function () {
        renderEchart();
      }

      // 表格数据
      var flowTableData = [
        ["排行", "适配器编码", "流量"],
        ["1", "102566587433", 10000],
        ["2", "102566587433", 9000],
        ["3", "102566587433", 8000],
        ["4", "102566587433", 7000],
        ["5", "102566587433", 6000],
        ["6", "102566587433", 5000],
        ["7", "102566587433", 4000],
        ["8", "102566587433", 3000],
        ["9", "102566587433", 2000],
        ["10", "102566587433", 1000]
      ];
      var terminalTableData = [
        ["排行", "设备名称[适配器编码]", "使用天数"],
        ["1", "102566587433", 10000],
        ["2", "102566587433", 9000],
        ["3", "102566587433", 8000],
        ["4", "102566587433", 7000],
        ["5", "102566587433", 6000],
        ["6", "102566587433", 5000],
        ["7", "102566587433", 4000],
        ["8", "102566587433", 3000],
        ["9", "102566587433", 2000],
        ["10", "102566587433", 1000]
      ];
      var faultTableData = [
        ["排行", "故障类型", "报警次数"],
        ["1", "102566587433", 10000],
        ["2", "102566587433", 9000],
        ["3", "102566587433", 8000],
        ["4", "102566587433", 7000],
        ["5", "102566587433", 6000],
        ["6", "102566587433", 5000],
        ["7", "102566587433", 4000],
        ["8", "102566587433", 3000],
        ["9", "102566587433", 2000],
        ["10", "102566587433", 1000]
      ];
      var moduleTableData = [
        ["排行", "功能模块", "浏览次数"],
        ["1", "102566587433", 10000],
        ["2", "102566587433", 9000],
        ["3", "102566587433", 8000],
        ["4", "102566587433", 7000],
        ["5", "102566587433", 6000],
        ["6", "102566587433", 5000],
        ["7", "102566587433", 4000],
        ["8", "102566587433", 3000],
        ["9", "102566587433", 2000],
        ["10", "102566587433", 1000]
      ];
      appendTable($('#flowTable'), flowTableData);
      appendTable($('#terminalTable'), terminalTableData);
      appendTable($('#faultTable'), terminalTableData);
      appendTable($('#moduleTable'), terminalTableData);

      /**
      * 排行数据表格动态添加函数
      * @param {*} $tableObj 表格容器对象
      * @param {*} tableData 表格数据
      * @returns 
      */
      function appendTable($tableObj, tableData) {
        var temp = '<table class="table table-hover table-condensed table-striped table-bordered"><thead></thead><tbody></tbody></table>';
        $tableObj.append(temp);
        var thead = "", tbody = "";
        tableData.map(function (item, index) {
          var tr = "";
          if (index == 0) {
            item.map(function (th) { tr += '<th>' + th + '</th>'; });
            thead += '<tr>' + tr + '</tr>';
          } else {
            item.map(function (td) { tr += '<td>' + td + '</td>'; });
            tbody += '<tr>' + tr + '</tr>';
          }
        });
        $tableObj.find("thead").append(thead);
        $tableObj.find("tbody").append(tbody);
      }
    })
  </script>
</body>
</body>

</html>